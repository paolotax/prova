<%= heading do %>	
	
    <%= h1 {"Riepiloghi"} %>

    <%= tag.div class: "pl-4 flex flex-col-reverse justify-center gap-2 sm:flex-row sm:justify-between sm:align-center sm:gap-4" do %>
        
        <%= render TaxButton.new(
                caption: "Indietro",
                svg_file: "icon-arrow-long-left.svg",
                color: "white",
                url: url_for( controller: "adozioni", action: "index", params: [] )
        ) %>
        
        <%= render TaxButton.new(
                caption: "Sbocci?",
                svg_file: "icon-plus.svg",
                color: "blue",
                url: url_for( controller: "adozioni", action: "new", model: @adozione ),
                data_attr: { turbo_frame: :modal, action: "click->dialog#open" }
        ) %>

    <% end %>

<% end %>

<% @vendite.collect do |adozione| %>
    <%= adozione.libro_titolo %> -
    <%= adozione.numero_copie %> --------
    <%= number_to_currency adozione.importo_cents / 100 %>
    <%= link_to "lista", adozioni_path(ids: adozione.adozione_ids.join(","))%>
    <br/>
<% end %>

<%= @vendite.sum(&:numero_copie) %> --------
<%= number_to_currency @vendite.sum(&:importo_cents) / 100 %>
    <br/>
    <br/>


<% @adozioni_per_disciplina.collect do |adozione| %>
    <%= adozione.libro_categoria %> -
    <%= adozione.numero_sezioni %>
    <br/>
<% end %>

<%= render StatComponent.new(type: "horizontal_bar", title: "Vendite Vacanze", current_value: current_user.adozioni.vendite.sum(:numero_copie), color: "blue") do |stat| %>
  <% stat.with_data_points( current_user.adozioni.vendite.per_libro_hash.map {|a| { x: a[:titolo], y: a[:numero_copie]} }  ) %>
<% end %>


<%= render partial: "adozioni/badges" %>
