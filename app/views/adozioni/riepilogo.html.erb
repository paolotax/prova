<%= heading do %>	
	
    <%= h1 {"Riepiloghi"} %>

    <%= tag.div class: "pl-4 flex flex-col-reverse justify-center gap-2 sm:flex-row sm:justify-between sm:align-center sm:gap-4" do %>
        
        <%= render TaxButton.new(
                caption: "Indietro",
                svg_file: "icon-arrow-long-left.svg",
                color: "white",
                url: url_for( controller: "adozioni", action: "index", params: [] )
        ) %>
        
        <%= render TaxButton.new(
                caption: "Sbocci?",
                svg_file: "icon-plus.svg",
                color: "blue",
                url: url_for( controller: "adozioni", action: "new", model: @adozione ),
                data_attr: { turbo_frame: :modal, action: "click->dialog#open" }
        ) %>

    <% end %>

<% end %>


<%# totale Vacanze %>

<%= render StatComponent.new(title: "Vacanze", width: "w-1/4", current_value: @vendite.sum(&:importo_cents) / 100.to_f) do |stat| %>
    <% stat.with_current_value_leader { "â‚¬" } %>
<% end %>


<%# stat per titolo %>

<%= render StatComponent.new(type: "horizontal_bar", width: "w-full", title: "Vendite Vacanze", current_value: current_user.adozioni.vendite.sum(:numero_copie), color: "blue") do |stat| %>
  <% stat.with_data_points( current_user.adozioni.vendite.per_libro_hash.map {|a| { x: a[:titolo], y: a[:numero_copie]} }  ) %>
<% end %>


<%# riepilogo per libro_titolo %>

<ul class="bg-white border rounded-2xl shadow-2xl px-4 my-2">
    <% @vendite.each do |vendita| %>
        <%= render ListItemComponent.new(
        ) do |list_item| %>
        
        <% list_item.with_leader do %>
            <% if vendita.editore == "GIUNTI SCUOLA" %>
            <%# Heroicons > outline > computer-desktop %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 textgray-500 shrink-0">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25" />
            </svg>
            <% else %>
            <%# Heroicons > outline > device-phone-mobile %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 textgray-500 shrink-0">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" />
            </svg>
            <% end %>
        <% end %>
        
        <%= link_to adozioni_path(ids: vendita.adozione_ids.join(",")), class: "w-full grid grid-cols-7 px-2 gap-2" do %>
                <%= tag.span vendita.libro_titolo, class: "col-span-2 text-base font-semibold text-gray-800" %>
                <%= tag.span vendita.numero_copie, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>

                <%= tag.span vendita.in_consegna, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
                <%= tag.span vendita.consegnato, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
                <%= tag.span vendita.giacenza, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
                <%= tag.span number_to_currency(vendita.importo_cents / 100), class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
            <% end %>
        <% end %>
    <% end %>
</ul>



<%# riepilogo per scuola %>

<ul class="bg-sky-100 border rounded-2xl shadow-2xl px-4 my-2">
    <% @vendite_per_scuola.each do |vendita| %>
        <%= render ListItemComponent.new(
        ) do |list_item| %>
        

        
        <%= link_to adozioni_path(ids: vendita.adozione_ids.join(",")), class: "w-full grid grid-cols-4 px-2 gap-2" do %>
                <%= tag.span vendita.DENOMINAZIONESCUOLA, class: "col-span-2 text-base font-semibold text-gray-800" %>
                <%= tag.span vendita.numero_copie, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
                <%= tag.span number_to_currency(vendita.importo_cents / 100), class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
            <% end %>
        <% end %>
    <% end %>
</ul>



<%# adozioni per disciplina %>

<ul class="bg-white border rounded-2xl shadow-2xl px-4 my-2">
<% @adozioni_per_disciplina.collect do |adozione| %>
        <%= render ListItemComponent.new(
        ) do |list_item| %>

        <%= link_to adozioni_path(ids: adozione.adozione_ids.join(",")), class: "w-full grid grid-cols-4 px-2 gap-2" do %>
                <%= tag.span adozione.libro_categoria, class: "col-span-2 text-base font-semibold text-gray-800" %>
                <%= tag.span adozione.numero_sezioni, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
             <% end %>
        <% end %>
<% end %>
</ul>


<%# adozioni per titolo %>

<ul class="bg-white border rounded-2xl shadow-2xl px-4 my-2">
<% current_user.adozioni.pre_adozioni.per_libro.map do |adozione| %>
        <%= render ListItemComponent.new(
        ) do |list_item| %>

        <%= link_to adozioni_path(ids: adozione.adozione_ids.join(",")), class: "w-full grid grid-cols-4 px-2 gap-2" do %>
                <%= tag.span adozione.titolo, class: "col-span-2 text-base font-semibold text-gray-800" %>
                <%= tag.span adozione.numero_sezioni, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
             <% end %>
        <% end %>
<% end %>
</ul>


<%# adozioni per scuola %>

<ul class="bg-sky-100 border rounded-2xl shadow-2xl px-4 my-2">
    <% current_user.adozioni.pre_adozioni.per_scuola.each do |vendita| %>
        <%= render ListItemComponent.new(
        ) do |list_item| %>
        

        
        <%= link_to adozioni_path(ids: vendita.adozione_ids.join(",")), class: "w-full grid grid-cols-4 px-2 gap-2" do %>
                <%= tag.span vendita.DENOMINAZIONESCUOLA, class: "col-span-2 text-base font-semibold text-gray-800" %>
                <%= tag.span vendita.numero_sezioni, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
            <% end %>
        <% end %>
    <% end %>
</ul>

<ul class="bg-sky-100 border rounded-2xl shadow-2xl px-4 my-2">
    <% current_user.adozioni.vendita.incassi.each do |vendita| %>
        <%= render ListItemComponent.new(
        ) do |list_item| %>
       
        <%= link_to adozioni_path(ids: vendita.adozione_ids.join(",")), class: "w-full grid grid-cols-6 px-2 gap-2" do %>
                <%= tag.span vendita.tipo, class: "col-span-1 text-base font-semibold text-gray-800" %>
                <%= tag.span vendita.status, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
                <%= tag.span vendita.tipo_pagamento, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
                <%= tag.span vendita.pagato_il, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
                <%= tag.span vendita.importo_cents / 100.0, class: "col-span-1 text-sm font-normal text-right text-gray-500" %>
            <% end %>
        <% end %>
    <% end %>
</ul>




<%#= render partial: "adozioni/badges" %>
