<% content_for :title, "Importa Adozioni da Excel" %>

<div class="container mx-auto px-4 py-8">
  <div class="max-w-2xl mx-auto">
    <h1 class="text-3xl font-bold text-gray-900 mb-6">Importa Adozioni da Excel</h1>
    
    <div class="bg-white p-6 rounded-lg shadow">
      <h2 class="text-lg font-medium text-gray-900 mb-4">Carica File Excel</h2>
      
      <%= form_with url: import_adozioni_comunicate_path, method: :post, multipart: true, local: true do |form| %>
        <div class="mb-4">
          <%= form.label :file, "File Excel", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.file_field :file, accept: ".xlsx,.xls", 
              class: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" %>
        </div>
        
        <div class="mb-4">
          <%= form.submit "Importa", 
              class: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg" %>
          <%= link_to "Annulla", adozioni_comunicate_path, 
              class: "bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-lg ml-2" %>
        </div>
      <% end %>
    </div>
    
    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-6">
      <h3 class="text-sm font-medium text-yellow-800 mb-2">Formato File Excel Richiesto</h3>
      <p class="text-sm text-yellow-700 mb-2">
        Il file Excel deve contenere le seguenti colonne:
      </p>
      <ul class="text-sm text-yellow-700 list-disc list-inside">
        <li><strong>Cod. Agente</strong> - Codice dell'agente</li>
        <li><strong>Anno</strong> - Anno scolastico</li>
        <li><strong>CodMinisteriale</strong> - Codice ministeriale della scuola</li>
        <li><strong>Descrizione</strong> - Nome della scuola</li>
        <li><strong>Indirizzo</strong> - Indirizzo della scuola</li>
        <li><strong>CAP</strong> - Codice postale</li>
        <li><strong>Comune</strong> - Comune</li>
        <li><strong>Provincia</strong> - Provincia</li>
        <li><strong>Cod. Sc.</strong> - Codice scuola</li>
        <li><strong>Editore</strong> - Codice editore</li>
        <li><strong>Ean</strong> - Codice EAN/ISBN del libro</li>
        <li><strong>Titolo</strong> - Titolo del libro</li>
        <li><strong>Classe</strong> - Classe scolastica</li>
        <li><strong>Sezione</strong> - Sezione della classe</li>
        <li><strong>Alunni</strong> - Numero di alunni</li>
      </ul>
    </div>
    
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4">
      <h3 class="text-sm font-medium text-blue-800 mb-2">Nota Importante</h3>
      <p class="text-sm text-blue-700">
        L'importazione sostituirà tutte le adozioni comunicate precedenti per il tuo account. 
        Il sistema cercherà automaticamente le corrispondenze con le tue adozioni esistenti.
      </p>
    </div>
  </div>
</div>
