<%= form_with(url: @url, method: :get, id: "form-filter", class: "w-full px-6 py-4 bg-gray-200 rounded-lg border shadow-lg") do |form| %>     
    <%# my-4 px-8 py-6 min-w-[260px] inline-flex gap-6 bg-white rounded-lg border %>
    <%= tag.div(class: "flex-col space-y-3") do %>
        <% @fields.each do |field| %>
            <%= tag.fieldset class: "relative" do %>
                <% if field[:type] == :text %>
			        <%#= form.label field[:field], field[:label].to_s.capitalize %>
                    <%= form.text_field field[:field], value: filter_params[field[:field]],
                        class: "peer block w-full border-0 bg-gray-50 py-1.5 text-gray-900 focus:ring-0 sm:text-sm sm:leading-6",
                        placeholder: field[:placeholder] %>
                    <%= tag.div class: "absolute inset-x-0 bottom-0 border-t border-gray-300 peer-focus:border-t-2 peer-focus:border-gray-900", aria: { hidden: "true" } %>
                
                <% elsif field[:type] == :select %>
                    <%#= form.label field[:field], field[:label].to_s.capitalize %>
                    <%= form.select field[:field], options_for_select(field[:collection], filter_params[field[:field]]), { include_blank: field[:placeholder] }, { class: "peer block w-full border-0 bg-gray-50 py-1.5 text-gray-900 focus:ring-0 sm:text-sm sm:leading-6" } %>
                    <%= tag.div class: "absolute inset-x-0 bottom-0 border-t border-gray-300 peer-focus:border-t-2 peer-focus:border-gray-900", aria: { hidden: "true" } %>                           
                
                <% elsif field[:type] == :checkbox %>
                    <%= component "tax_toggle_button", 
                            field: field[:field],
                            checked: params[field[:field]] == "si", 
                            button_color: "gray-900" %>

                <% end %>
            <% end %>
        <% end %>


        <%= tag.div class: "mt-2 flex flex-row-reverse justify-between items-center" do %>
            
            <%= render ButtonComponent.new(state: 'secondary', busy_content_css: 'flex [[disabled]_&]:opacity-0', data: { turbo_frame: "search_results", turbo_action: "advance" }) do |button| %>
                <% button.with_busy_content(css: "absolute inset-0 w-full justify-center items-center") do %>
                    <svg stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.    /2000/svg" class="size-4"><style>.spinner{transform-origin:center; animation:spinner_outside 2s linear infinite}.spinner circle{stroke-linecap:round;animation:spinner_inside 1.5s ease-in-out infinite}@keyframes spinner_outside{100%{transform:rotate(360deg)}}@keyframes spinner_inside{0%{stroke-dasharray:0 150;stroke-dashoffset:0}47.5%{stroke-dasharray:42 150;stroke-dashoffset:-16}95%,100%{stroke-dasharray:42 150;stroke-dashoffset:-59}}</style><g class="spinner"><circle cx="12" cy="12" r="9.5" fill="none" stroke-width="2"></circle></g></svg>
                <% end %>
                Filtra
            <% end %>

            <%=  link_to "reset", @url, class: "text-xs font-semibold text-red-500", data: { turbo_frame: "search_results", turbo_action: "advance"} %>
        <% end %>
        
    <% end %>
<% end %>